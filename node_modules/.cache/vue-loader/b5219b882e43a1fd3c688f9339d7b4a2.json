{"remainingRequest":"/Users/nyg/Work/NayDev/KST_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nyg/Work/NayDev/KST_web/src/components/Catalogos/TiposCicloEscolar.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/nyg/Work/NayDev/KST_web/src/components/Catalogos/TiposCicloEscolar.vue","mtime":1658340540146},{"path":"/Users/nyg/Work/NayDev/KST_web/node_modules/css-loader/dist/cjs.js","mtime":1657481266095},{"path":"/Users/nyg/Work/NayDev/KST_web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1657481275629},{"path":"/Users/nyg/Work/NayDev/KST_web/node_modules/postcss-loader/src/index.js","mtime":1657481268740},{"path":"/Users/nyg/Work/NayDev/KST_web/node_modules/cache-loader/dist/cjs.js","mtime":1657481261281},{"path":"/Users/nyg/Work/NayDev/KST_web/node_modules/vue-loader/lib/index.js","mtime":1657481273148}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjAwcHgpIHsKICAuYWN0aXZvX2xhYmVsOjpiZWZvcmUgewogICAgY29udGVudDogIkVzdGFkbyAiOwogIH0KCiAgLnBhZGRpbmctbW9kZWwgewogICAgcGFkZGluZy1sZWZ0OiA2cHg7CiAgICBwYWRkaW5nLXJpZ2h0OiA2cHg7CiAgfQp9Cg=="},{"version":3,"sources":["TiposCicloEscolar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAybA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"TiposCicloEscolar.vue","sourceRoot":"src/components/Catalogos","sourcesContent":["<template>\n  <div class=\"container is-max-desktop\">\n    <div class=\"col-12\" id=\"Titulo\">\n      <h1 class=\"titulo_azul\">Ciclo Escolar</h1>\n      <div class=\"line_red\"></div>\n    </div>\n    <div class=\"col-12 row filtros_div\" id=\"filtros_div\">\n      <div class=\"col-12 filtro_titulo\">\n        <div class=\"row\">\n          <div class=\"col-10\">\n            <h1 class=\"col-10\">Favor de indicar filtros</h1>\n          </div>\n          <div\n            class=\"col-2\"\n            @click=\"mostrarFiltros = !mostrarFiltros\"\n            :key=\"mostrarFiltros\"\n          >\n            <i\n              class=\"fas fa-angle-down\"\n              v-if=\"!mostrarFiltros\"\n              style=\"float: right;\"\n            ></i>\n            <i\n              class=\"fas fa-angle-up\"\n              v-if=\"mostrarFiltros\"\n              style=\"float: right;\"\n            ></i>\n          </div>\n        </div>\n      </div>\n      <div v-if=\"mostrarFiltros\" class=\"col-12 row\">\n        <div class=\"col-4\">\n          <label>Año de inicio</label>\n          <input\n            class=\"form-control\"\n            type=\"number\"\n            min=\"0\"\n            v-model=\"filtro_añoDeInicio\"\n            \n          />\n        </div>\n            \n        <div class=\"col-4\">\n          <label>Año de termino</label>\n          <input\n            class=\"form-control\"\n            type=\"number\"\n            min=\"0\"\n            v-model=\"filtro_añoDeTermino\"\n          />\n        </div>\n        <div class=\"col-4\">\n          <label class=\"activo_label\">Activo</label>\n          <select class=\"form-control\" v-model=\"filtro_activo\">\n            <option value=\"-1\">Seleccionar Activo</option>\n            <option value=\"1\">Si</option>\n            <option value=\"0\">No</option>\n          </select>\n        </div>\n      </div>\n      <div v-if=\"mostrarFiltros\" class=\"filtro_footer\">\n        <button class=\"button is-default btn-sm mr-1\" @click=\"limpiarFiltros()\">\n          Mostrar Todo\n        </button>\n        <button\n          class=\"button is-primary btn-sm\"\n          @click=\"getTiposDeCicloEscolar()\"\n        >\n          Filtrar\n        </button>\n      </div>\n    </div>\n    <div class=\"col-12\" style=\"margin-bottom:100px;\">\n      <button\n        class=\"button is-primary mt-5 mb-1 align-left\"\n        @click=\"abrirModal('Agregar', {})\"\n      >\n        <i class=\"fas fa-plus\" style></i>&nbsp;&nbsp;Agregar ciclo escolar\n      </button>\n      <br />\n      <div class=\"row col-12\" v-if=\"items.length <= 0\" style=\"display: grid; justify-content: center;\">\n        <p>No se encontraron registros</p>\n      </div>\n      <div id=\"bootstrap_table\" v-else>\n        <div class=\"col-3 mr-0 align-rigth\">\n          <input\n            class=\"form-control\"\n            v-model=\"filter\"\n            type=\"search\"\n            placeholder=\"Buscar\"\n            @blur=\"currentPage = 1\"\n          />\n        </div>\n        <b-table\n          striped\n          hover\n          outlined\n          :items=\"items\"\n          :fields=\"fields\"\n          :per-page=\"perPage\"\n          :current-page=\"currentPage\"\n          :filter=\"filter\"\n        >\n          <template v-slot:cell(Activo)=\"data\">\n          <button class=\"btn btn-default\" v-if=\"data.item.Activo == 1\" :key=\"data.item.TipoDeCicloEscolarId\" style=\"cursor: default;\">     \n            <i\n              class=\"far fa-check-square\"\n              style=\"color: green\"\n            ></i>\n            </button>\n            <button class=\"btn btn-default\" v-else :key=\"data.item.TipoDeCicloEscolarId\" style=\"cursor: default;\">\n            <i class=\"far fa-times-circle\" style=\"color: red\"></i>\n            </button>\n          </template>\n          <template v-slot:cell(opciones)=\"data\">\n            <button\n              class=\"button is-info is-small\"\n              @click=\"abrirModal('Editar', data.item)\"\n              value=\"Editar\"\n              title=\"Editar\"\n            >\n              <i class=\"far fa-edit\"></i>\n            </button>\n            <button\n              class=\"button is-danger is-small\"\n              :disabled=\"data.item.Activo == 0\"\n              @click=\"cancelar(data.item)\"\n              value=\"Eliminar\"\n              title=\"Cancelar\"\n            >\n              <i class=\"fas fa-ban\"></i>\n            </button>\n          </template>\n        </b-table>\n        <b-pagination\n          v-model=\"currentPage\"\n          :total-rows=\"rows\"\n          :per-page=\"perPage\"\n        ></b-pagination>\n      </div>\n    </div>\n    <div v-if=\"mostrarModal\" class=\"modal_div\" id=\"modal_div\">\n      <transition name=\"modal\">\n        <div class=\"modal-mask\">\n          <div class=\"modal-wrapper\">\n            <div class=\"modal-dialog\">\n              <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                  <div class=\"col-11\">\n                    <h2 class=\"modal-title text-center\">\n                      {{ titutoModal }} Ciclo Escolar\n                    </h2>\n                    <div class=\"line_red\"></div>\n                  </div>\n                  <a class=\"button close_modal\" @click=\"mostrarModal = false\">\n                    <span aria-hidden=\"true\">&times;</span>\n                  </a>\n                </div>\n                <div class=\"modal-body\">\n                  <div class=\"row\">\n                    <div class=\"col-5 form-group padding-model\">\n                      <label>Año de inicio</label>\n                      <input\n                        type=\"number\"\n                        min=\"0\"\n                        class=\"form-control\"\n                        v-model=\"item.AñoDeInicio\"\n                      />\n                    </div>\n                    <div class=\"col-5 form-group padding-model\">\n                      <label>Año de termino</label>\n                      <input\n                        type=\"number\"\n                        min = \"0\"\n                        class=\"form-control\"\n                        v-model=\"item.AñoDeTermino\"\n                        \n                      />\n                    </div>\n                    <div class=\"col-2 padding-model\">\n                      <label>Activo</label>\n                      <select class=\"form-control\" v-model=\"item.Activo\">\n                        <option value=\"1\">Si</option>\n                        <option value=\"0\">No</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"modal-footer\">\n                  <button\n                    type=\"button\"\n                    class=\"button is-primary\"\n                    @click=\"guardarTipoDeCicloEscolar()\"\n                    \n                  >\n                    Guardar\n                  </button>\n                  <button\n                    type=\"button\"\n                    class=\"btn btn-secondary\"\n                    data-dismiss=\"modal\"\n                    @click=\"mostrarModal = false\"\n                  >\n                    Cancelar\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </transition>\n    </div>\n    <cargando v-if=\"isLoading\"></cargando>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport routeAPI from \"@/js/api\";\n\nexport default {\n  name: \"TiposDeCicloEscolar\",\n  data() {\n    return {\n      isLoading: false,\n      items: [],\n      item: {\n        AñoDeInicio: Number,\n        AñoDeTermino: Number,\n        Activo: Boolean,\n      },\n      fields: [\n        {\n          key: \"TipoDeCicloEscolarId\",\n          label: \"Folio\",\n          sortable: true,\n        },\n        {\n          key: \"AñoDeInicio\",\n          sortable: true,\n        },\n        {\n          key: \"AñoDeTermino\",\n          sortable: true,\n        },\n        {\n          label: \"Activo\",\n          key: \"Activo\",\n        },\n        {\n          label: \"Opciones\",\n          key: \"opciones\",\n        },\n      ],\n      filter: \"\",\n      perPage: 5,\n      currentPage: 1,\n      mostrarModal: false,\n      titutoModal: \"\",\n      mostrarFiltros: true,\n      filtro_añoDeInicio: new Date().getFullYear() - 5,\n      filtro_añoDeTermino: new Date().getFullYear(),\n      filtro_activo: \"-1\",\n    };\n  },\n  created() {\n    this.getTiposDeCicloEscolar();\n  },\n  computed: {\n    rows() {\n      return this.items.length;\n    },\n  },\n  methods: {\n    // Obtener todos los ciclos escolares\n    async getTiposDeCicloEscolar() {\n      try {\n        this.isLoading = true;\n        this.limpiarVariables();\n        const filtros = {\n          filtro: {},\n        };\n\n        if (this.filtro_añoDeInicio != \"\")\n          filtros.filtro.inicio = Number(this.filtro_añoDeInicio);\n        if (this.filtro_añoDeTermino != \"\")\n          filtros.filtro.fin = Number(this.filtro_añoDeTermino);\n        if (this.filtro_activo != \"\" && Number(this.filtro_activo) > 0)\n          filtros.filtro.activo = Number(this.filtro_activo);\n\n        const response = await axios.post(\n          routeAPI + \"administracion/tiposDeCicloEscolar\",\n          filtros\n        );\n\n        if (!response.data.hayError) {\n          if (response.data.response.length > 0) {\n            response.data.response.forEach((element) => {\n              this.items.push({\n                TipoDeCicloEscolarId: element[\"002TipoDeCicloEscolarId\"],\n                AñoDeInicio: element[\"002AñoDeInicio\"],\n                AñoDeTermino: element[\"002AñoDeTermino\"],\n                Activo: element[\"002Activo\"],\n              });\n            });\n          }\n        } else{\n          console.log(response);\n          this.$alert(\n            \"No se pudo obtener información, favor de volverlo a intentar.\"\n          );\n        }\n\n        this.isLoading = false;\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    abrirModal: function(tipo, item) {\n      this.titutoModal = tipo;\n      this.item = item;\n      this.mostrarModal = !this.mostrarModal;\n    },\n    async guardarTipoDeCicloEscolar() {\n      if (this.item.TipoDeCicloEscolarId > 0) {\n        this.editarTipoDeCicloEscolar();\n      } else {\n        this.agregarTipoDeCicloEscolar();\n      }\n    },\n    async agregarTipoDeCicloEscolar() {\n      try {\n        if (this.$store.getters.userId <= 0 || this.$store.getters.userId == undefined) {          \n          this.$router.push({ name: \"Login\" });\n        }\n        \n        this.isLoading = true;\n        const data = {\n          tipoDeCicloEscolar: {\n            TipoDeCicloEscolarId: null,\n            Inicio: Number(this.item.AñoDeInicio),\n            Termino: Number(this.item.AñoDeTermino), \n            UsuarioId: this.$store.getters.userId,\n            Activo: Number(this.item.Activo),            \n          },\n        };\n\n        const response = await axios.post(\n          routeAPI + \"administracion/guardarTiposDeCicloEscolar\",\n          data\n        );\n\n        this.mostrarModal = false;\n        this.isLoading = false;\n        if (!response.data.hayError) {\n          if(this.item.AñoDeTermino>this.item.AñoDeInicio)\n          {\n           this.$alert(\"El ciclo escolar se guardó con éxito.\");\n           this.getTiposDeCicloEscolar();\n          }\n          else\n          {\n            this.$alert(\"El año de Termino no puede ser anterior al año de inicio\");\n          }\n        } else {\n          console.log(response);\n          this.$alert(\"No se pudo guardar, favor de volverlo a intentar.\");\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    async editarTipoDeCicloEscolar() {\n      try {\n        this.isLoading = true;\n        const data = {\n          tipoDeCicloEscolar: {\n            TipoDeCicloEscolarId: this.item.TipoDeCicloEscolarId,\n            Inicio: Number(this.item.AñoDeInicio),\n            Termino: Number(this.item.AñoDeTermino),\n            Activo: Number(this.item.Activo),\n          },\n        };\n\n        const response = await axios.post(\n          routeAPI + \"administracion/editarTiposDeCicloEscolar\",\n          data\n        );\n\n        this.mostrarModal = false;\n        this.isLoading = false;\n        if (!response.data.hayError) {\n          this.$alert(\"El ciclo escolar se guardó con éxito.\");\n          this.getTiposDeCicloEscolar();\n        } else {\n          console.log(response);\n          this.$alert(\"No se pudo guardar, favor de volverlo a intentar.\");\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    async cancelar(item) {\n      try {\n        this.isLoading = true;\n        const data = {\n          tipoDeCicloEscolar: {\n            TipoDeCicloEscolarId: item.TipoDeCicloEscolarId,\n            Activo: Number(0),\n          },\n        };\n\n        const response = await axios.post(\n          routeAPI + \"administracion/cancelarTiposDeCicloEscolar\",\n          data\n        );\n        this.isLoading = false;\n        if (!response.data.hayError) {\n          this.$alert(\"El ciclo escolar se canceló correctamente.\");\n          this.getTiposDeCicloEscolar();\n        } else {\n          console.log(response);\n          this.$alert(\"No se pudo cancelar, favor de volverlo a intentar.\");\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    limpiarVariables: function() {\n      this.items = [];\n    },\n    limpiarFiltros() {\n      this.filtro_añoDeInicio = \"\";\n      this.filtro_añoDeTermino = \"\";\n      this.filtro_activo = \"-1\";\n    },\n  },\n};\n</script>\n\n<style>\n@media screen and (max-width: 600px) {\n  .activo_label::before {\n    content: \"Estado \";\n  }\n\n  .padding-model {\n    padding-left: 6px;\n    padding-right: 6px;\n  }\n}\n</style>\n"]}]}